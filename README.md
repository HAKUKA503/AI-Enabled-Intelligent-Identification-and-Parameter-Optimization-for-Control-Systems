# 控制系统的智能辨识与参数优化实验

## 1. 问题分析

### 1.1 任务背景

加热炉作为工业过程控制中的典型对象，需将炉温稳定在设定值。传统控制依赖预设模型与手动参数调试，效率低且难以兼顾复杂工况。本任务通过经典辨识方法从阶跃响应数据中提取加热炉模型，并利用遗传算法优化PID控制器参数，提升控制精度与鲁棒性。

### 1.2 系统辨识与模型验证

#### 1.2.1 数据处理与参数估计

- 预处理 `temperature.csv` 数据，修正0秒电压为0，保存为 `data.csv`。
- 提取关键特征点，分析时间-温度曲线，确定稳态区间。
- 使用切线法和最小二乘法估计参数 \( K \)、\( T \)、\( \theta \)。

#### 1.2.2 模型验证与精度分析

- 通过计算RMSE、MAE、R²等指标验证模型准确性。
- 绘制残差图，检查误差分布，验证辨识方法的可靠性。

### 1.3 PID 闭环控制与智能优化算法

#### 1.3.1 PID 控制逻辑与设计

- 设计带抗积分饱和的PID控制器，比例环节加快响应，积分环节消除稳态误差，微分环节抑制超调。
- 当控制量限幅时，通过回退积分项抑制积分饱和。

#### 1.3.2 遗传算法优化流程

- 以最小化综合适应度函数为目标，采用遗传算法对PID参数进行全局优化。
- 流程包括种群初始化、遗传操作（选择、交叉、变异）和迭代优化。

## 2. 实验过程

### 2.1 系统辨识与模型验证

#### 2.1.1 数据预处理与特征提取

- 修正数据，绘制时间-温度曲线，计算稳态均值。

#### 2.1.2 参数估计

- 使用切线法和最小二乘法估计 \( K \)、\( T \)、\( \theta \)。

#### 2.1.3 模型验证

- 计算误差指标，绘制残差图，验证模型准确性。

### 2.2 PID 控制器设计与遗传算法优化

#### 2.2.1 PID 控制逻辑实现

- 使用Python定义 `PIDController` 类，实现PID控制逻辑。

#### 2.2.2 遗传算法优化流程

- 定义适应度函数，初始化种群，进行遗传操作，迭代优化PID参数。

## 3. 实验结果及分析

### 3.1 系统辨识与模型验证

- 提取得到系统模型参数：\( K=3644.35°C/V \)、\( T=2902s \)、\( \theta=190s \)。
- 模型验证结果表明误差控制在较低水平，拟合度高达99.35%。

### 3.2 PID闭环控制与智能优化

- 遗传算法优化得到最优PID参数：\( K_p=0.724 \)、\( K_i=0.00076134 \)、\( K_d=33.424 \)。
- 闭环系统实现超调量1.57%、稳态误差0.00℃的理想效果，动态响应特性符合大惯性滞后系统的控制要求。

## 4. 总结体会

- 融合经典控制理论与智能优化技术，理解传统方法与数据驱动方法的互补性。
- 通过代码实现，避免积分累积误差，提升稳态精度。
- 培养“问题分解—算法设计—调试优化”的工程思维，方法论可迁移至其他工业控制场景。

